<div class="spacing-search">
  <d-button class="button" bsStyle="primary" (click)="OnNewRow('standard')">New</d-button>
  <d-search
    class="search"
    [(ngModel)]="queryParam.tagKey"
    [iconPosition]="'left'"
    (searchFn)="fetchData()"
    (change)="fetchData()"
  >
  </d-search>
  <d-button class="button" bsStyle="common" (click)="fetchData()">Filter</d-button>
</div>
<div class="spacing-table">
  <d-data-table
    dLoading
    [dataSource]="table.data"
    [tableOverflowType]="'overlay'"
    [backdrop]="true"
    [scrollable]="true"
    [headerBg]="true"
    [showLoading]="table.showLoading"
  >
    <thead dTableHead [checkable]="true">
    <tr dTableRow>
      <th
        dHeadCell
        *ngFor="let column of columns"
      >
        {{ column.header }}
      </th>
      <th dHeadCell [fixedRight]="'0px'">Actions</th>
    </tr>
    </thead>
    <tbody dTableBody>
    <ng-template let-rowItem="rowItem" let-rowIndex="rowIndex" let-nestedIndex="nestedIndex">
      <tr dTableRow [ngClass]="{ 'table-row-selected': rowItem.$checked,'table-row-invalid': !(rowItem['valid']) }">
        <td dTableCell class="devui-checkable-cell">
          <d-checkbox
            [ngModelOptions]="{ standalone: true }"
            [ngModel]="rowItem.$checked"
            [halfchecked]="rowItem.$halfChecked"
            (ngModelChange)="onRowCheckChange($event, rowIndex, nestedIndex, rowItem)"
          >
          </d-checkbox>
        </td>
        <td
          dTableCell
          *ngFor="let column of columns"
          [ngSwitch]="column.field"
          [width]="'1500px'"
        >
          <span *ngSwitchCase="'createTime'">
          {{ (rowItem[column.field] | i18nDate: 'full') }}
          </span>
          <span *ngSwitchCase="'color'">
           <input type="color" [value]="(rowItem['color'])" disabled="true"/>
          </span>
          <span *ngSwitchDefault>
          {{ rowItem[column.field] }}
          </span>
        </td>
        <td dTableCell class="devui-checkable-cell" [fixedRight]="'0px'" [width]="'200px'">
          <d-icon-group>
            <d-icon [icon]="'icon-edit'" [operable]="true" (click)="onRowEdit((rowItem),'standard')"></d-icon>
            <d-icon [icon]="'icon-priority'" [operable]="true" [color]="getValid()">
            </d-icon>
            <span dDropDown appendToBody>
                <d-icon dDropDownToggle [icon]="'icon-more-operate'" [operable]="true"></d-icon>
                <ul dDropDownMenu >
                  <li class="devui-dropdown-item" (click)="onDelete($event)">删除</li>
                </ul>
              </span>
          </d-icon-group>
        </td>
      </tr>
    </ng-template>
    </tbody>
    <ng-template #noResultTemplateRef>
      <div class="no-data">No Data</div>
    </ng-template>
  </d-data-table>
</div>
<d-pagination
  class="spacing-pagination"
  [total]="table.pager.total"
  [(pageSize)]="table.pager.pageSize"
  [(pageIndex)]="table.pager.pageIndex"
  [canViewTotal]="true"
  [canChangePageSize]="true"
  [maxItems]="5"
  (pageIndexChange)="pageIndexChange($event)"
  (pageSizeChange)="pageSizeChange($event)"
>
</d-pagination>
